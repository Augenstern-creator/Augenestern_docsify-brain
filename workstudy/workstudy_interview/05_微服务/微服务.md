# 1、微服务架构面试题

## 1.1、什么是微服务

- 微服务是一种软件架构风格，它将应用程序拆分成一系列小型、独立的服务，每个服务都运行在其自己的进程中，通过轻量级通信机制进行通信。
- 每个服务都具有明确的业务能力，并且可以独立开发、测试、部署和扩展。
- 微服务架构的核心思想是将应用程序分解为多个小型服务，每个服务都具有独立的功能和责任。每个服务都可以独立地开发、测试、部署和扩展，从而提高了应用程序的可维护性、可扩展性和灵活性。

微服务的优点主要包括：

1. 独立性：每个微服务都是独立的、可独立部署和扩展的。
2. 轻量级通信：微服务之间通过轻量级通信机制进行通信，例如基于HTTP的RESTful API或者消息队列等。
3. 单一职责：每个微服务都专注于特定的业务能力，具有明确的职责和边界。
4. 松耦合：微服务之间的依赖关系尽量减少，每个微服务都可以独立地运行和更新。
5. 灵活性：微服务架构使得系统更加灵活，可以根据实际需求进行灵活的组合和使用，提高了系统的可维护性和可重用性。
6. 每个服务可以独立使用数据库：每个服务可以使用自己的数据库，这使得每个服务都可以根据其业务需求独立地存储和检索数据。
7. 开发体验好：由于每个服务都是独立的，开发人员只需要关注自己的业务领域，这使得开发更加快速和高效。
8. 按需扩容：由于每个服务都可以独立地进行部署和扩展，因此可以根据需求进行灵活的扩容。

微服务的缺点主要包括：

1. 处理故障难度高：由于微服务是分布式系统，故障的处理可能会更加复杂。例如，当某个服务出现故障时，需要确定故障的原因并进行修复，这可能需要跨多个服务进行调试和排查。
2. 部署工作量大：由于每个服务都需要进行独立的部署，因此部署的工作量可能会比单体应用程序要大得多。
3. 测试复杂度高：由于微服务之间存在复杂的依赖关系，因此测试的复杂度可能会比单体应用程序要高。
4. 运营成本增加：由于每个服务都需要进行独立的监控和管理，因此运营的成本可能会比单体应用程序要高。
5. 发布风险高：由于每个服务都可能有自己的发布计划和时间表，因此可能会出现不同服务的版本不一致的情况，这可能会导致一些潜在的风险。
6. 分布性系统问题：由于微服务是分布式系统，因此可能会面临一些分布式系统的常见问题，例如网络延迟、服务调用失败、系统容量规划等。



## 1.2、分布式与微服务的区别

微服务是一种架构风格，是架构设计层面的概念；而分布式是一种项目系统的部署方式，是部署层面的概念。

- 分布式系统，即是将一个项目中的各个服务分散部署在不同的机器上的，一个服务可能负责几个功能，分布式系统可以看做是若干个独立计算机的集合，这些服务在不同的计算机上部署，但还是属于同一个项目。
  - 这些服务之间一般通过RPC（远程过程调用）来进行交互（调用）。分布式系统核心在我看来其实相当于是对RPC的应用，将一个整体项目中的各个服务进行拆分，将原本在本地调用的方式改为分开部署、远程调用，实现对系统一定程度的解耦和对物理资源的最大化利用，便于某个核心业务的单独横向扩展（集群）。
- 微服务是一种架构风格，是以开发一组小型服务的方式来作为一个独立的应用系统，每个服务都运行在自已的进程中，服务之间采用轻量级的HTTP通信机制 ( 通常是采用HTTP的RESTful API )进行通信。
  - 微服务是一种架构风格，微服务就是很小的一个服务，相较于以往常见的单体应用，微服务的核心思想是将一个大项目的各个业务模块甚至某个单一功能抽离出来，作为一个单独的完整项目，单独部署，该应用只需要为该大项目或者其他项目的业务模块提供服务即可。

> 从分布式和微服务的概念来看，都是对一个项目系统进行了拆分，一个是在部署层面，一个是在架构设计层面。
>
> - 微服务相较于分布式来说，细粒度更小，服务间的耦合度更低，并且可以说微服务一定是分服务分开部署的，所以其实微服务是基于分布式的，更像是对分布式系统的一种优化，因此很多时候微服务架构也被称为是分布式的架构，区别于分布式系统。





## 1.3、微服务怎么划分原则

微服务的服务划分原则主要包括以下几点：

1. 单一职责原则：每个微服务应该只负责一个特定的业务功能。单一职责原则有助于保持服务的聚焦和简单，便于独立开发和维护。如果一个服务承担了过多的职责，它可能会变得臃肿和复杂，从而影响到整个系统的健壮性和可维护性。
2. 业务领域驱动划分：根据应用程序的业务需求和领域知识来对服务进行划分。这通常需要与业务专家和开发人员紧密合作，共同识别和定义各个领域的边界。通过领域驱动的划分，可以确保各个微服务的业务逻辑紧密联系在一起，便于维护和拓展。
3. 层次结构清晰：微服务要有层次结构，不能形成网状，应该要有比较清晰的层次划分，分为高、低层，每层可以有多个服务，高层单向调用低层，同一层级之间可互调。
4. 独立性：每个微服务都应该是独立的、可独立部署和扩展的。每个服务都应该具有自己的数据库、通信机制和身份验证等独立的功能模块。
5. 可扩展性：每个微服务都应该能够独立地进行扩展，例如增加服务器、数据库等资源，以满足不断增长的用户需求。
6. 松耦合：微服务之间的依赖关系应该尽量减少，每个微服务都可以独立地运行和更新。这可以提高系统的容错性和可维护性。
7. 独立部署和扩展：每个微服务都应该能够独立地进行部署和扩展，以满足不同用户的需求和服务质量要求。
8. 服务间通信简单：微服务之间的通信机制应该简单、可靠和高效，例如使用RESTful API或者消息队列等。
9. 数据一致性：在分布式系统中，数据一致性是一个重要的问题。微服务架构需要处理不同服务之间的数据一致性问题，例如使用分布式事务或者基于消息的异步通信等。
10. 日志和监控：每个微服务都应该具有独立的日志和监控机制，以便及时发现和解决问题。

总之，微服务的服务划分原则是确保每个微服务都具有清晰的责任和边界，便于独立开发、部署、扩展和维护。同时，要确保整个系统的松耦合和高内聚性，以提高系统的可靠性和可维护性。







## 1.4、微服务之间是如何进行通讯的

微服务之间可以通过不同的通信方式进行通信，包括同步通信和异步通信。

- 同步通信是指微服务之间通过请求-响应的方式进行通信，例如RESTful API和RPC。在同步通信中，请求方需要等待响应方的返回结果，因此可靠性较高，但可能会出现请求排队、线程阻塞等问题，从而影响系统的响应速度和并发性能。
- 异步通信是指微服务之间通过消息队列进行异步通信，例如Kafka和RabbitMQ。在异步通信中，发送方向消息队列发送消息，接收方从消息队列中消费消息，消息传输以异步的方式进行，不需要等待接收方的响应。由于解耦性高，消息队列还可以支持发布-订阅模式，消息得以广播到多个服务中，助于构建高可伸缩的系统。不过异步通信也可能导致延迟较高，以及可靠性和容错性较差等问题。





## 1.5、简述什么是服务注册与发现

服务注册与发现是微服务架构中的一个关键概念，它解决了在分布式系统中，服务实例如何相互找到并通信的问题。其核心思想是在动态环境中，服务可以自动地注册自己并在需要时被其他服务发现。

- 服务注册是指每个服务实例在启动后，会向一个集中的服务注册中心（或称为服务目录）报告自己的存在、网络地址、端口号等信息。这一步骤确保了所有可用的服务实例都记录在一个地方，方便其他服务查找和调用。
- 服务发现则是指当一个服务需要调用另一个服务时，它不是直接通过硬编码的地址去访问目标服务，而是查询服务注册中心来获取当前可用的服务实例列表，并从中选择一个进行调用。服务发现通常包括两种模式：
  - **客户端发现**：在这种模式下，客户端负责从服务注册中心检索服务提供者列表，并决定调用哪个实例。这可能涉及到负载均衡策略的选择。
  - **服务器端发现**：在这种模式下，请求首先到达一个中介（如API网关或反向代理），由这个中介负责查询服务注册中心，并将请求转发给合适的后端服务实例。

服务注册与发现机制还应该支持动态更新和服务实例的健康状态监控。例如，如果某个服务实例变得不可用（比如因为崩溃或者维护），它应当从注册中心移除，以避免其他服务尝试与其通信。此外，许多实现还会定期对服务实例执行健康检查，以确保它们处于良好状态。





## 1.6、请列举常用的服务注册发现的组件

1. **Eureka**
   - 由Netflix开发，是一个基于REST的服务注册与发现工具，专为云设计。它包括两个主要组件：Eureka Server（服务注册中心）和服务实例上的Eureka Client（客户端）。服务启动时会向Eureka Server注册自己，并定期发送心跳来更新其状态。
2. **Consul**
   - HashiCorp开发的工具，不仅提供服务发现功能，还支持健康检查、分布式配置管理等特性。Consul可以跨多个数据中心工作，并且具有Web UI用于管理和监控。
3. **Zookeeper**
   - Apache ZooKeeper是由Apache开发的协调服务，最初为Hadoop生态系统的一部分。它提供了强大的一致性保证和快速的读取性能。尽管Zookeeper不是专门为微服务设计的，但它仍然被广泛应用于服务发现场景中。
4. **etcd**
   - CoreOS推出的一个高可用的键值存储系统，用于共享配置和服务发现。etcd背后的设计理念是CAP理论中的CP（一致性和分区容忍性），即在任何情况下都能保证数据的一致性。
5. **Nacos**
   - 阿里巴巴开源的服务发现与配置管理基础设施，集成了服务注册、配置管理和服务治理的功能。Nacos支持多种协议，如DNS、HTTP等，并且易于集成到现有的微服务体系中。





## 1.7、简述什么是服务调用

服务调用是微服务架构中的一个核心概念，指的是一个服务实例如何与另一个服务实例进行交互以完成特定的任务或获取所需的数据。在分布式系统中，服务调用通常是跨网络的远程过程调用（RPC），意味着一个服务（客户端）会向另一个服务（服务器）发送请求，并等待响应。

- Feign是一个声明式的Web服务客户端，最初由Netflix开发，现在是Spring Cloud的一部分。它简化了HTTP API客户端的编写，使得开发者可以通过简单的注解来定义服务接口，自动完成HTTP请求的构建和发送。
- Ribbon是一个客户端负载均衡器，它可以与RestTemplate或Feign结合使用，为HTTP和TCP客户端提供软负载均衡能力。Ribbon允许在应用程序级别配置负载均衡策略，而无需依赖外部硬件设备。
- Dubbo提供了透明化的远程过程调用、智能负载均衡、自动服务注册与发现等功能，特别适合大型分布式系统中的细粒度服务划分。



## 1.8、简述什么是服务降级

服务降级是微服务架构中用于提高系统弹性和用户体验的一种策略。它是指当某个服务或系统的部分功能不可用或性能严重下降时，为了保证核心业务的正常运行，临时性地降低某些非关键功能的服务质量或直接关闭这些功能，从而减少对整个系统的压力。

- 





































































































